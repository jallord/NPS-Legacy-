@ECHO OFF

TITLE BatteriesPlus Bulbs New PC SCRIPT WIN7.v1.171003
:: NAMING SCHEME FOR SCRIPT VERSION (OS).v(IMAGE INDICATOR).(YEAR)(MONTH)(DAY)
color 0F

:: **** NOTES FOR COLOR ABOVE ****

:: First = Background Color
:: Second = Text Color
:: (EXAMPLE: color 0A)

:: 0 = Black       8 = Gray
:: 1 = Blue        9 = Light Blue
:: 2 = Green       A = Light Green
:: 3 = Aqua        B = Light Aqua
:: 4 = Red         C = Light Red
:: 5 = Purple      D = Light Purple
:: 6 = Yellow      E = Light Yellow
:: 7 = White       F = Bright White

:: **** END NOTES ****

CD /D %~dp0

:WINDOWS7CHECK

CLS

ECHO *************************************************************************
ECHO ****               BATTERIES PLUS BULBS NEW PC SCRIPT                ****
ECHO ****                   New PC SCRIPT WIN7.v1.171003                  ****
ECHO ****                        WINDOWS 7 (LEGACY)                       ****     
ECHO ****             By Jacob Allord/Andy Gossen/David Humlie            ****
ECHO *************************************************************************

ECHO.
ECHO.

:: ##      ## #### ##    ##    ########     ######  ########    ###    ########  ######## 
:: ##  ##  ##  ##  ###   ##    ##    ##    ##    ##    ##      ## ##   ##     ##    ##    
:: ##  ##  ##  ##  ####  ##        ##      ##          ##     ##   ##  ##     ##    ##    
:: ##  ##  ##  ##  ## ## ##       ##        ######     ##    ##     ## ########     ##    
:: ##  ##  ##  ##  ##  ####      ##              ##    ##    ######### ##   ##      ##    
:: ##  ##  ##  ##  ##   ###      ##        ##    ##    ##    ##     ## ##    ##     ##    
::  ###  ###  #### ##    ##      ##         ######     ##    ##     ## ##     ##    ##   

ECHO ************************************************************************
ECHO *****  THIS SCRIPT IS DESIGNED FOR WINDOWS 7 (LEGACY) IMAGE ONLY   *****
ECHO *****  DO NOT RUN THIS SCRIPT IF THE OS IS NOT WINDOWS 7 (LEGACY)  *****
ECHO ************************************************************************
ECHO. 
wmic bios get serialnumber
wmic computersystem get model
ECHO.
ECHO.
ECHO.Enter "WIN7LEGACY" to start the windows 7 (legacy) script
ECHO Enter "CMC" to install cmc only
ECHO Enter "CLOSE" to exit
ECHO.
Set /P C=[WIN7LEGACY or Close]:

IF /I %C%==WIN7LEGACY GOTO STARTINGWINDOWS7
IF /I %C%==CLOSE GOTO GOODBYE
IF /I %C%==HOST GOTO HOST?
IF /I %C%==CMC GOTO 64OR32CMC


ECHO INVALID ENTRY! PRESS ANY KEY TO TRY AGAIN...
PAUSE >NUL
GOTO WINDOWS7CHECK

:GOODBYE
ECHO.
ECHO GOODBYE...
choice /C X /T 5 /D X > nul
EXIT


:STARTINGWINDOWS7


ECHO.
ECHO.
ECHO Starting Windows 7 Script...........
choice /C X /T 3 /D X > nul
ECHO.
ECHO.

:CHOICE

ECHO.[R] REGISTER
ECHO.[T] TECH CENTER PC
ECHO.[B] BACK OFFICE
ECHO.[K] KIOSK
ECHO.
Set /P C=Which PC Is This? [R/T/B/K]:

IF /I %C%==R GOTO REGISTER32
IF /I %C%==T GOTO TECH32
IF /I %C%==B GOTO BACKOFFICE
IF /I %C%==K GOTO KIOSKBIT?



ECHO INVALID ENTRY! PRESS ANY KEY TO TRY AGAIN
PAUSE >NUL
GOTO CHOICE


:REGISTER32

:: ##      ## #### ##    ##    ########    ########     
:: ##  ##  ##  ##  ###   ##    ##    ##    ##     ##    
:: ##  ##  ##  ##  ####  ##        ##      ##     ##    
:: ##  ##  ##  ##  ## ## ##       ##       ########     
:: ##  ##  ##  ##  ##  ####      ##        ##   ##      
:: ##  ##  ##  ##  ##   ###      ##        ##    ##     
::  ###  ###  #### ##    ##      ##        ##     ##    

TITLE 32 BIT REGISTER SCRIPT WINDOWS 7
ECHO *******************************************************
ECHO *         STARTING REGISTER 32 PC SCRIPT WIN 7        *
ECHO *******************************************************


CD /D %~dp0

:CHOICEREGISTER32
ECHO.
ECHO.
ECHO *******************************************************
ECHO *                SYMANTEC REMOVAL CHECK               *
ECHO *******************************************************
Set /P C=Did you remove Symantec?[Y/N]

IF /I %C%==Y GOTO SSLCHECKR32
IF /I %C%==N GOTO NOTREMOVEDR32

ECHO INVALID ENTRY! PRESS ANY KEY TO TRY AGAIN
PAUSE >NUL
GOTO CHOICEREGISTER32

:SSLCHECKR32
ECHO.
ECHO.
ECHO *******************************************************
ECHO *              CERTIFICATE INSTALL CHECK              *
ECHO *******************************************************
Set /P C=Did you install the SSL cert?[Y/N]

IF /I %C%==Y GOTO GREATJOBR32
IF /I %C%==N GOTO SSLNOTADDEDR32

ECHO INVALID ENTRY! PRESS ANY KEY TO TRY AGAIN
PAUSE >NUL
GOTO SSLCHECKR32

:GREATJOBR32
ECHO.
ECHO.
ECHO. GOOD JOB! To Continue Script Press Enter.
PAUSE >Nul
GOTO CONTINUER32

:NOTREMOVEDR32
ECHO.
ECHO.
ECHO. You forgot to remove symantec! Run Clean Wipe Now!
CleanWipe.exe
Pause >NUL
GOTO EXIT

:SSLNOTADDEDR32
ECHO.
ECHO.
ECHO. You forgot the install the SSL cert! Install Now!
ECHO. Press any key to close the script. 
Pause >NUL
GOTO EXITR32

:EXITR32
EXIT

:CONTINUER32

SET /P Name=Enter the Computer name:

:: -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
:: --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

ECHO Renaming Computer...
choice /C X /T 1 /D X > nul
wmic computersystem where name="%computername%" call rename name ="%Name%"
ECHO Complete!
ECHO.

:: --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
:: --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

ECHO Changing Description...
choice /C X /T 1 /D X > nul
net config server /srvcomment:"%Name%"
ECHO Complete!
ECHO.

:: --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
:: --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

ECHO Joining BATTERIESPLUS workgroup...
choice /C X /T 1 /D X > nul
wmic computersystem where name="%computername%" call joindomainorworkgroup name="BATTERIESPLUS"
ECHO Complete!
ECHO.

:: --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
:: --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

ECHO Setting Wallpaper...
choice /C X /T 1 /D X > nul
copy plusguy.jpg c:\windows\plusguy.jpg
REG ADD "HKCU\Control Panel\Desktop" /f /v WallpaperStyle /t REG_SZ /d 0
REG ADD "HKCU\Control Panel\Desktop" /f /v Wallpaper /t REG_SZ /d c:\windows\plusguy.jpg
ECHO Complete!
ECHO.

:: --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
:: --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

ECHO Installing Screen Saver...
choice /C X /T 1 /D X > nul
start /wait PlusGuy2013.exe
ECHO Complete!
ECHO.

:: --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
:: --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

ECHO Installing Citrix...
choice /C X /T 1 /D X > nul
start /wait CitrixReceiverWeb.exe
ECHO Complete!
ECHO.

:: --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
:: --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

ECHO Removing the "Add Account" citrix popup...
REG ADD HKLM\Software\Policies\Citrix /f /v EnableX1FTU /t REG_DWORD /d 00000000
REG ADD HKLM\Software\Wow6432Node\Policies\Citrix /f /v EnableX1FTU /t REG_DWORD /d 00000000
REG ADD HKCU\Software\Policies\Citrix /f /v EnableX1FTU /t REG_DWORD /d 00000000
REG ADD HKCU\Software\Wow6432Node\Policies\Citrix /f /v EnableX1FTU /t REG_DWORD /d 00000000

:: --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
:: --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

ECHO Installing Ingenico Drivers...
choice /C X /T 1 /D X > nul
start /wait Jungo2.8.exe
ECHO Complete!
ECHO.

:: --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
:: --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

ECHO Opening Device Manager for COM5 Ingenico Port verification...
choice /C X /T 1 /D X > nul
start /wait devmgmt.msc
ECHO Complete!
ECHO.

:: --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
:: --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

ECHO Installing EPSON TM-T88V Config Utility... 
choice /C X /T 1 /D X > nul
start /wait TM-T88VUtility170.exe
ECHO Complete!
ECHO.

:: --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
:: --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

ECHO Installing EPSON TM-T88V Port Emulation Tool...
choice /C X /T 1 /D X > nul
start /wait TMVirtualPortDriver850a.exe
ECHO Complete!
ECHO.

:: --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
:: --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

ECHO Running plugin Flash Update utility...
choice /C X /T 1 /D X > nul
start /wait Updater.exe
ECHO Complete!
ECHO.

:: --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
:: --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

ECHO Running plugin Update utility...
choice /C X /T 1 /D X > nul
start /wait Updater2.exe
ECHO Complete!
ECHO.

:: --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
:: --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

ECHO Create a system restore point. 
ECHO DO NOT SKIP THIS
ECHO 1) CLICK THE SYSTEM PROTECTION TAB
ECHO 2) CLICK CREATE
ECHO 3) NAME THE BACKUP Before Kaspersky
ECHO 4) CLICK CREATE
RESTOREPOINT.TXT
systempropertiesprotection
ECHO.

:: --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
:: --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

ECHO Installing Kaspersky Network Agent...
choice /C X /T 1 /D X > nul
start /wait setup_NA013017.exe
ECHO Complete!
ECHO.

:: --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
:: --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

ECHO Installing Kaspersky...
choice /C X /T 1 /D X > nul
start /wait setup013017.exe
ECHO Complete!
ECHO.

:: --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
:: --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

ECHO Installing CMC....
GOTO 64OR32CMC

:: --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
:: --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------


:TECH32

:: ##      ## #### ##    ##    ########    ########     
:: ##  ##  ##  ##  ###   ##    ##    ##       ##        
:: ##  ##  ##  ##  ####  ##        ##         ##     
:: ##  ##  ##  ##  ## ## ##       ##          ##      
:: ##  ##  ##  ##  ##  ####      ##           ##              
:: ##  ##  ##  ##  ##   ###      ##           ##          
::  ###  ###  #### ##    ##      ##           ##       

TITLE 32 BIT TECH CENTER SCRIPT WINDOWS 7
ECHO *******************************************************
ECHO *         STARTING TECH CENTER 32 SCRIPT WIN 7        *
ECHO *******************************************************


CD /D %~dp0

:CHOICETECH32
ECHO *******************************************************
ECHO *                SYMANTEC REMOVAL CHECK               *
ECHO *******************************************************
Set /P C=Did you remove Symantec?[Y/N]

IF /I %C%==Y GOTO CONTINUET32
IF /I %C%==N GOTO NOTREMOVEDT32

ECHO INVALID ENTRY! PRESS ANY KEY TO TRY AGAIN
PAUSE >NUL
GOTO CHOICETECH32

:CONTINUET32
ECHO.
ECHO.
ECHO. GOOD JOB! To Continue Script Press Enter.
PAUSE >Nul
GOTO CONTINUET32

:NOTREMOVEDT32
ECHO.
ECHO.
ECHO. You forgot to remove symantec! Run Clean Wipe Now!
CleanWipe.exe
Pause >NUL
GOTO EXITT32

:EXITT32
EXIT

:CONTINUET32


@ECHO OFF

SET /P Name=Enter the Computer name:

ECHO.

ECHO Renaming Computer...
choice /C X /T 1 /D X > nul
wmic computersystem where name="%computername%" call rename name ="%Name%"
ECHO Complete!
ECHO.

:: --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
:: --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

ECHO Changing Description...
choice /C X /T 1 /D X > nul
net config server /srvcomment:"%Name%"
ECHO Complete!
ECHO.

:: --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
:: --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

ECHO Joining BATTERIESPLUS workgroup...
choice /C X /T 1 /D X > nul
wmic computersystem where name="%computername%" call joindomainorworkgroup name="BATTERIESPLUS"
ECHO Complete!
ECHO.

:: --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
:: --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

ECHO Setting Wallpaper...
choice /C X /T 1 /D X > nul
copy plusguy.jpg c:\windows\plusguy.jpg
REG ADD "HKCU\Control Panel\Desktop" /f /v WallpaperStyle /t REG_SZ /d 0
REG ADD "HKCU\Control Panel\Desktop" /f /v Wallpaper /t REG_SZ /d c:\windows\plusguy.jpg
ECHO Complete!
ECHO.

:: --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
:: --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

ECHO Installing Screen Saver...
choice /C X /T 1 /D X > nul
start /wait PlusGuy2013.exe
ECHO Complete!
ECHO.

:: --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
:: --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

ECHO Installing Citrix Plugin...
choice /C X /T 1 /D X > nul
start /wait CitrixReceiverWeb.exe
ECHO Complete!
ECHO.

:: --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
:: --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

ECHO Removing the "Add Account" citrix popup...
REG ADD HKLM\Software\Policies\Citrix /f /v EnableX1FTU /t REG_DWORD /d 00000000
REG ADD HKLM\Software\Wow6432Node\Policies\Citrix /f /v EnableX1FTU /t REG_DWORD /d 00000000
REG ADD HKCU\Software\Policies\Citrix /f /v EnableX1FTU /t REG_DWORD /d 00000000
REG ADD HKCU\Software\Wow6432Node\Policies\Citrix /f /v EnableX1FTU /t REG_DWORD /d 00000000

:: --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
:: --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

ECHO Running plugin Flash Update utility...
choice /C X /T 1 /D X > nul
start /wait Updater.exe
ECHO Complete!
ECHO.

:: --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
:: --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

ECHO Running plugin Update utility...
choice /C X /T 1 /D X > nul
start /wait Updater2.exe
ECHO Complete!
ECHO.

:: --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
:: --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

ECHO Create a system restore point. 
ECHO DO NOT SKIP THIS
ECHO 1) CLICK THE SYSTEM PROTECTION TAB
ECHO 2) CLICK CREATE
ECHO 3) NAME THE BACKUP Before Kaspersky
ECHO 4) CLICK CREATE
RESTOREPOINT.TXT
systempropertiesprotection
ECHO.

:: --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
:: --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

ECHO Installing Kaspersky Network Agent...
choice /C X /T 1 /D X > nul
start /wait setup_NA013017.exe
ECHO Complete!
ECHO.

:: --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
:: --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

ECHO Installing Kaspersky...
choice /C X /T 1 /D X > nul
start /wait setup013017.exe
ECHO Complete!
ECHO.

:: --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
:: --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------


ECHO Installing CMC....
GOTO 64OR32CMC


:: --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
:: --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

:KIOSK32

:: ##      ## #### ##    ##    ########    ##    ##    
:: ##  ##  ##  ##  ###   ##    ##    ##    ##   ##     
:: ##  ##  ##  ##  ####  ##        ##      ##  ##      
:: ##  ##  ##  ##  ## ## ##       ##       #####       
:: ##  ##  ##  ##  ##  ####      ##        ##  ##      
:: ##  ##  ##  ##  ##   ###      ##        ##   ##     
::  ###  ###  #### ##    ##      ##        ##    ##    


TITLE 32 BIT KIOSK PC SCRIPT WINDOWS 7

ECHO *******************************************************
ECHO *          STARTING KIOSK PC 32 SCRIPT WIN 7          *
ECHO *******************************************************


CD /D %~dp0

:CHOICEKIOSK32
ECHO *******************************************************
ECHO *                SYMANTEC REMOVAL CHECK               *
ECHO *******************************************************
Set /P C=Did you remove Symantec?[Y/N]

IF /I %C%==Y GOTO CONTINUEK32
IF /I %C%==N GOTO NOTREMOVEDK32

ECHO Invalid Entry! Press any key to continue.
PAUSE >NUL
GOTO CHOICEKIOSK32

:CONTINUEK32
ECHO.
ECHO.
ECHO. GOOD JOB! To Continue Script Press Enter.
PAUSE >Nul
GOTO CONTINUEK32

:NOTREMOVEDK32
ECHO.
ECHO.
ECHO. You forgot to remove symantec! Run Clean Wipe Now!
CleanWipe.exe
Pause >NUL
GOTO EXITK32

:EXITK32
EXIT

:CONTINUEK32


@ECHO OFF


SET /P Name=Enter the Computer name:
ECHO.

:: --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
:: --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

ECHO Renaming Computer...
choice /C X /T 1 /D X > nul
wmic computersystem where name="%computername%" call rename name ="%Name%"
ECHO Complete!
ECHO.

:: --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
:: --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

ECHO Changing Description...
choice /C X /T 1 /D X > nul
net config server /srvcomment:"%Name%"
ECHO Complete!
ECHO.

:: --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
:: --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

ECHO Joining BATTERIESPLUS workgroup...
choice /C X /T 1 /D X > nul
wmic computersystem where name="%computername%" call joindomainorworkgroup name="BATTERIESPLUS"
ECHO Complete!
ECHO.

:: -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
:: --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

ECHO Setting Wallpaper...
choice /C X /T 1 /D X > nul
copy plusguy.jpg c:\windows\plusguy.jpg
REG ADD "HKCU\Control Panel\Desktop" /f /v WallpaperStyle /t REG_SZ /d 0
REG ADD "HKCU\Control Panel\Desktop" /f /v Wallpaper /t REG_SZ /d c:\windows\plusguy.jpg
ECHO Complete!
ECHO.

:: --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
:: --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

ECHO Installing Screen Saver...
choice /C X /T 1 /D X > nul
start /wait PlusGuy2013.exe
ECHO Complete!
ECHO.

:: --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
:: --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

ECHO Installing Citrix Plugin...
choice /C X /T 1 /D X > nul
start /wait CitrixReceiverWeb.exe
ECHO Complete!
ECHO.

:: --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
:: --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

ECHO Removing the "Add Account" citrix popup...
REG ADD HKLM\Software\Policies\Citrix /f /v EnableX1FTU /t REG_DWORD /d 00000000
REG ADD HKLM\Software\Wow6432Node\Policies\Citrix /f /v EnableX1FTU /t REG_DWORD /d 00000000
REG ADD HKCU\Software\Policies\Citrix /f /v EnableX1FTU /t REG_DWORD /d 00000000
REG ADD HKCU\Software\Wow6432Node\Policies\Citrix /f /v EnableX1FTU /t REG_DWORD /d 00000000

:: --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
:: --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

ECHO Running plugin Flash Update utility...
choice /C X /T 1 /D X > nul
start /wait Updater.exe
ECHO Complete!
ECHO.

:: --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
:: --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

ECHO Running plugin Update utility...
choice /C X /T 1 /D X > nul
start /wait Updater2.exe
ECHO Complete!
ECHO.

:: --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
:: --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

ECHO Create a system restore point. 
ECHO DO NOT SKIP THIS
ECHO 1) CLICK THE SYSTEM PROTECTION TAB
ECHO 2) CLICK CREATE
ECHO 3) NAME THE BACKUP Before Kaspersky
ECHO 4) CLICK CREATE
RESTOREPOINT.TXT
systempropertiesprotection
ECHO.

:: --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
:: --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

ECHO Installing Kaspersky Network Agent...
choice /C X /T 1 /D X > nul
start /wait setup_NA013017.exe
ECHO Complete!
ECHO.

:: --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
:: --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

ECHO Installing Kaspersky...
choice /C X /T 1 /D X > nul
start /wait setup013017.exe
ECHO Complete!
ECHO.

:: --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
:: --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

ECHO Installing CMC....
GOTO 64OR32CMC

:: --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
:: --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------


:BACKOFFICE

:: ##      ## #### ##    ##    ########    ########   #######  
:: ##  ##  ##  ##  ###   ##    ##    ##    ##     ## ##     ## 
:: ##  ##  ##  ##  ####  ##        ##      ##     ## ##     ## 
:: ##  ##  ##  ##  ## ## ##       ##       ########  ##     ## 
:: ##  ##  ##  ##  ##  ####      ##        ##     ## ##     ## 
:: ##  ##  ##  ##  ##   ###      ##        ##     ## ##     ## 
::  ###  ###  #### ##    ##      ##        ########   #######  

TITLE BACK OFFICE SCRIPT WINDOWS 7
ECHO *******************************************************
ECHO *          STARTING BACK OFFICE SCRIPT WIN 7          *
ECHO *******************************************************


CD /D %~dp0

:CHOICEBACKOFFICE
ECHO *******************************************************
ECHO *                SYMANTEC REMOVAL CHECK               *
ECHO *******************************************************
Set /P C=Did you remove Symantec?[Y/N]

IF /I %C%==Y GOTO CONTINUEBO
IF /I %C%==N GOTO NOTREMOVEDBO

ECHO Invalid Entry! Press any key to continue.
PAUSE >NUL
GOTO CHOICEBACKOFFICE

:CONTINUEBO
ECHO.
ECHO.
ECHO. GOOD JOB! To Continue Script Press Enter.
PAUSE >Nul
GOTO CONTINUEBO

:NOTREMOVEDBO
ECHO.
ECHO.
ECHO. You forgot to remove symantec! Run Clean Wipe Now!
CleanWipe.exe
Pause >NUL
GOTO EXITBO

:EXITBO
EXIT

:CONTINUEBO

@ECHO OFF

SET /P Store=Enter the 3 digit store #:
SET /P Name=Enter the Computer name:

:: --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
:: --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------


ECHO Renaming Computer...
choice /C X /T 1 /D X > nul
wmic computersystem where name="%computername%" call rename name ="%Name%"
ECHO Complete!
ECHO.

:: --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
:: --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

ECHO Changing Description...
choice /C X /T 1 /D X > nul
net config server /srvcomment:"%Name%"
ECHO Complete!
ECHO.

:: --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
:: --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

ECHO Joining BATTERIESPLUS workgroup...
choice /C X /T 1 /D X > nul
wmic computersystem where name="%computername%" call joindomainorworkgroup name="BATTERIESPLUS"
ECHO Complete!
ECHO.

:: --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
:: --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

ECHO Setting Wallpaper...
choice /C X /T 1 /D X > nul
copy plusguy.jpg c:\windows\plusguy.jpg
REG ADD "HKCU\Control Panel\Desktop" /f /v WallpaperStyle /t REG_SZ /d 0
REG ADD "HKCU\Control Panel\Desktop" /f /v Wallpaper /t REG_SZ /d c:\windows\plusguy.jpg
ECHO Complete!
ECHO.

:: --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
:: --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

ECHO Installing Screen Saver...
choice /C X /T 1 /D X > nul
start /wait PlusGuy2013.exe
ECHO Complete!
ECHO.

:: --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
:: --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

ECHO Installing Citrix Plugin...
choice /C X /T 1 /D X > nul
start /wait CitrixReceiverWeb.exe
ECHO Complete!
ECHO.

:: --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
:: --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

ECHO Removing the "Add Account" citrix popup...
REG ADD HKLM\Software\Policies\Citrix /f /v EnableX1FTU /t REG_DWORD /d 00000000
REG ADD HKLM\Software\Wow6432Node\Policies\Citrix /f /v EnableX1FTU /t REG_DWORD /d 00000000
REG ADD HKCU\Software\Policies\Citrix /f /v EnableX1FTU /t REG_DWORD /d 00000000
REG ADD HKCU\Software\Wow6432Node\Policies\Citrix /f /v EnableX1FTU /t REG_DWORD /d 00000000

:: --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
:: --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

ECHO Running plugin Flash Update utility...
choice /C X /T 1 /D X > nul
start /wait Updater.exe
ECHO Complete!
ECHO.

:: --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
:: --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

ECHO Running plugin Update utility...
choice /C X /T 1 /D X > nul
start /wait Updater2.exe
ECHO Complete!
ECHO.

:: --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
:: --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

ECHO Create a system restore point. 
ECHO DO NOT SKIP THIS
ECHO 1) CLICK THE SYSTEM PROTECTION TAB
ECHO 2) CLICK CREATE
ECHO 3) NAME THE BACKUP Before Kaspersky
ECHO 4) CLICK CREATE
RESTOREPOINT.TXT
systempropertiesprotection
ECHO.

:: --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
:: --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

ECHO Installing Kaspersky Network Agent...
choice /C X /T 1 /D X > nul
start /wait setup_NA013017.exe
ECHO Complete!
ECHO.

:: --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
:: --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

ECHO Installing Kaspersky...
choice /C X /T 1 /D X > nul
start /wait setup013017.exe
ECHO Complete!
ECHO.

:: --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
:: --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

ECHO Installing windows updates...
GOTO WINUPDATE


:: --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
:: --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

:64OR32CMC

ECHO.
ECHO.
ECHO.[A] 32BIT
ECHO.[B] 64BIT
ECHO.
Set /P C=Is this PC 32 OR 64 BIT? [A/B]:

IF /I %C%==A GOTO CMCINSTALL32
IF /I %C%==B GOTO CMCINSTALL64

ECHO INVALID ENTRY! PRESS ANY KEY TO TRY AGAIN.
PAUSE >NUL
GOTO 64OR32CMC


:CMCINSTALL32

@ECHO OFF
:: --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
:: --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

ECHO Installing Command Center...
choice /C X /T 1 /D X > nul
start /wait CmcInst_100317.exe
ECHO Complete!
ECHO.

:: SETLOCAL ENABLEDELAYEDEXPANSION
:: CALL :LoCase Host
:: CALL :CMC
:: ENDLOCAL

ECHO Command Center File has been created and placed in the proper directory...
choice /C X /T 1 /D X > nul
DEL /F /S /Q /A "C:\Program Files\Radiant Systems\CMC\siteTopology.config"
ECHO Complete!
ECHO.

ECHO Granting EVERYONE full access to CMC Update folder.
choice /C X /T 1 /D X > nul	
icacls "c:\Program Files\Radiant Systems\CMC\Update" /grant Everyone:(OI)(CI)F /c /t
DEL /F /S /Q /A "C:\Program Files\Radiant Systems\CMC\siteTopology.config"
ECHO Complete!
ECHO.

ECHO Setting Command Center Services to auto-start...
choice /C X /T 1 /D X > nul
Sc config CmcAgent start= auto
Sc config CmcSvcWatcher start= auto
Sc config RadSprtA start= auto
ECHO Complete!
ECHO.

ECHO Restarting Command Center Services...
choice /C X /T 1 /D X > nul
net stop CmcAgent
net stop CmcSvcWatcher
net stop RadSprtA
net start CmcAgent
net start CmcSvcWatcher
net start RadSprtA
ECHO Complete!
ECHO.

ECHO.
ECHO.
::SET /P Host=Is this machine the CMC Host? (Y or N):
:: SET File=text.txt
::ECHO.

:::LoCase
:: Subroutine to convert a variable VALUE to all lower case.
:: The argument for this subroutine is the variable NAME.
::SET %~1=!%1:N=n!
::SET %~1=!%1:Y=y!
::GOTO:EOF

:HOST?

ECHO.
Set /P HOST=Is this PC the host? [Y/N]:

IF /I %HOST%==Y GOTO HOST32
IF /I %HOST%==N GOTO NONHOST32

ECHO INVALID ENTRY! PRESS ANY KEY TO TRY AGAIN
PAUSE >NUL
GOTO HOST?

:: :CMC
:HOST32
:: IF %Host%==y (
	SET /P Store=Enter the 3 digit store #:
	SET /P Key=Enter the CMC Key ID:
	ECHO.
	ECHO           Node # Values
		ECHO           T1 = 301
		ECHO           K1 = 302
		ECHO           R1 = 401
		ECHO           R2 = 402
		ECHO           ANY EXTRA INCREMENT BY ONE (EX. 403, 404)
		ECHO.
	SET /P Node=Enter Node # Value:
	SET ipaddress=0.0.0.0 
	SET gateway=on
	SET File="C:\Program Files\Radiant Systems\CMC\CommandCenter.config"
::	)
ECHO ^<?xml version="1.0"?^>>%File% && ECHO ^<commandcenter^>>>%File% && ECHO   ^<gateway mode="%gateway%" ipAddress="%ipaddress%" /^>>>%File% && ECHO   ^<siteId value="%Key%" /^>>>%File% && ECHO   ^<unitNumber value="%Store%" /^>>>%File% && ECHO   ^<nodeNumber value="%Node%" /^>>>%File% && ECHO.|set /P ="</commandcenter>" >>%File%

ECHO.
ECHO.
ECHO.
ECHO. CMC INSTALLATION COMPLETE. PRESS ENTER TO CONTINUE
PAUSE >NUL

GOTO WINUPDATE

:NONHOST32
:: IF NOT %Host%==y (
	ECHO.
	ECHO           Register Host IP     = 172.24.1.2
	ECHO           Non-Register Host IP = 172.24.2.2
	ECHO.
	SET /P ipaddress=Enter IP Address Of Host:
	SET /P Store=Enter the 3 digit store #:
	SET /P Key=Enter the CMC Key ID:
	ECHO.
	ECHO           Node # Values
		ECHO           T1 = 301
		ECHO           K1 = 302
		ECHO           R1 = 401
		ECHO           R2 = 402
		ECHO           ANY EXTRA INCREMENT BY ONE (EX. 403, 404)
		ECHO.
	SET /P Node=Enter Node # Value:
	SET File="C:\Program Files\Radiant Systems\CMC\CommandCenter.config"
	SET gateway=off
:: )
ECHO ^<?xml version="1.0"?^>>%File% && ECHO ^<commandcenter^>>>%File% && ECHO   ^<gateway mode="%gateway%" ipAddress="%ipaddress%" /^>>>%File% && ECHO   ^<siteId value="%Key%" /^>>>%File% && ECHO   ^<unitNumber value="%Store%" /^>>>%File% && ECHO   ^<nodeNumber value="%Node%" /^>>>%File% && ECHO.|set /P ="</commandcenter>" >>%File%

ECHO.
ECHO.
ECHO.
ECHO. CMC INSTALLATION COMPLETE. PRESS ENTER TO CONTINUE
PAUSE >NUL

GOTO WINUPDATE


:: --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
:: --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
:: --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

:CMCINSTALL64

:: --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
:: --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

ECHO Installing Command Center...
choice /C X /T 1 /D X > nul
start /wait CmcInst_100317.exe
ECHO Complete!
ECHO.

:: SETLOCAL ENABLEDELAYEDEXPANSION
:: CALL :LoCase Host
:: CALL :CMC
:: ENDLOCAL

ECHO Command Center File has been created and placed in the proper directory...
choice /C X /T 1 /D X > nul
DEL /F /S /Q /A "C:\Program Files (x86)\Radiant Systems\CMC\siteTopology.config"
ECHO Complete!
ECHO.

ECHO Granting EVERYONE full access to CMC Update folder.
choice /C X /T 1 /D X > nul	
icacls "c:\Program Files\Radiant Systems\CMC\Update" /grant Everyone:(OI)(CI)F /c /t
DEL /F /S /Q /A "C:\Program Files (x86)\Radiant Systems\CMC\siteTopology.config"
ECHO Complete!
ECHO.

ECHO Setting Command Center Services to auto-start...
choice /C X /T 1 /D X > nul
Sc config CmcAgent start= auto
Sc config CmcSvcWatcher start= auto
Sc config RadSprtA start= auto
ECHO Complete!
ECHO.

ECHO Restarting Command Center Services...
choice /C X /T 1 /D X > nul
net stop CmcAgent
net stop CmcSvcWatcher
net stop RadSprtA
net start CmcAgent
net start CmcSvcWatcher
net start RadSprtA
ECHO Complete!
ECHO.

ECHO.
ECHO.
::SET /P Host=Is this machine the CMC Host? (Y or N):
:: SET File=text.txt
::ECHO.

:::LoCase
:: Subroutine to convert a variable VALUE to all lower case.
:: The argument for this subroutine is the variable NAME.
::SET %~1=!%1:N=n!
::SET %~1=!%1:Y=y!
::GOTO:EOF

:HOST?

ECHO.
Set /P HOST=Is this PC the host? [Y/N]:

IF /I %HOST%==Y GOTO HOST64
IF /I %HOST%==N GOTO NONHOST64

ECHO INVALID ENTRY! PRESS ANY KEY TO TRY AGAIN
PAUSE >NUL
GOTO HOST?

:: :CMC
:HOST64
:: IF %Host%==y (
	SET /P Store=Enter the 3 digit store #:
	SET /P Key=Enter the CMC Key ID:
	ECHO.
	ECHO           Node # Values
		ECHO           T1 = 301
		ECHO           K1 = 302
		ECHO           R1 = 401
		ECHO           R2 = 402
		ECHO           ANY EXTRA INCREMENT BY ONE (EX. 403, 404)
		ECHO.
	SET /P Node=Enter Node # Value:
	SET ipaddress=0.0.0.0 
	SET gateway=on
	SET File="C:\Program Files (x86)\Radiant Systems\CMC\CommandCenter.config"

::	)
ECHO ^<?xml version="1.0"?^>>%File% && ECHO ^<commandcenter^>>>%File% && ECHO   ^<gateway mode="%gateway%" ipAddress="%ipaddress%" /^>>>%File% && ECHO   ^<siteId value="%Key%" /^>>>%File% && ECHO   ^<unitNumber value="%Store%" /^>>>%File% && ECHO   ^<nodeNumber value="%Node%" /^>>>%File% && ECHO.|set /P ="</commandcenter>" >>%File%

ECHO.
ECHO.
ECHO.
ECHO. CMC INSTALLATION COMPLETE. PRESS ENTER TO CONTINUE
PAUSE >NUL

GOTO WINUPDATE

:NONHOST64
:: IF NOT %Host%==y (
	ECHO.
	ECHO           Register Host IP     = 172.24.1.2
	ECHO           Non-Register Host IP = 172.24.2.2
	ECHO.
	SET /P ipaddress=Enter IP Address Of Host:
	SET /P Store=Enter the 3 digit store #:
	SET /P Key=Enter the CMC Key ID:
	ECHO.
	ECHO           Node # Values
		ECHO           T1 = 301
		ECHO           K1 = 302
		ECHO           R1 = 401
		ECHO           R2 = 402
		ECHO           ANY EXTRA INCREMENT BY ONE (EX. 403, 404)
		ECHO.
	SET /P Node=Enter Node # Value:
	SET File="C:\Program Files (x86)\Radiant Systems\CMC\CommandCenter.config"
	SET gateway=off
:: )
ECHO ^<?xml version="1.0"?^>>%File% && ECHO ^<commandcenter^>>>%File% && ECHO   ^<gateway mode="%gateway%" ipAddress="%ipaddress%" /^>>>%File% && ECHO   ^<siteId value="%Key%" /^>>>%File% && ECHO   ^<unitNumber value="%Store%" /^>>>%File% && ECHO   ^<nodeNumber value="%Node%" /^>>>%File% && ECHO.|set /P ="</commandcenter>" >>%File%
ECHO.
ECHO.
ECHO.
ECHO. CMC INSTALLATION COMPLETE. PRESS ENTER TO CONTINUE
PAUSE >NUL

GOTO WINUPDATE


:: --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
:: --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
:: --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

:WINUPDATE
ECHO.
ECHO.
ECHO.
ECHO READ MESSAGE BEFORE INSTALLING WINDOWS UPDATES.
ECHO  ######  ########  #######  ########  
ECHO ##    ##    ##    ##     ## ##     ## 
ECHO ##          ##    ##     ## ##     ## 
ECHO  ######     ##    ##     ## ########  
ECHO       ##    ##    ##     ## ##        
ECHO ##    ##    ##    ##     ## ##        
ECHO  ######     ##     #######  ##  
WindowsUpdates.txt
ECHO Complete!
ECHO.

:: --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
:: --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

ECHO Opening Windows Updates...
choice /C X /T 1 /D X > nul

%windir%\system32\wuapp.exe


:: --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
:: --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
GOTO END
:: --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
:: --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------


:END
ECHO Thank you for using the WINDOWS 7 (LEGACY) new PC script.
ECHO Closing script in 5 seconds

